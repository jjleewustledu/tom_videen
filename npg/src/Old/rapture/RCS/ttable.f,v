head	1.1;
access;
symbols;
locks; strict;
comment	@c @;


1.1
date	93.11.17.20.24.42;	author ty7777;	state Exp;
branches;
next	;


desc
@X window version, first release.
@


1.1
log
@Initial revision
@
text
@C$Id$
C$Log$
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
C  Subroutine:   TTABLE.FTN
C
C  Author:       Tom O. Videen
C  Date:         29-Aug-90
C  Written For:  RAPTURE
C
C  History:
C     Modified 17-Nov-93 by Tom Yang to port to UNIX workstations.
C
C  Intent:
C     This subroutine returns 1 of 2 parameters given the request:
C
C     RETURNP = T --> returns an upper bound on the probability of T
C     RETURNP = F --> returns an lower bound on critical T for a
C                     a difference with probability P
C
C     TWOTAIL = T --> 2-tailed test
C     TWOTAIL = F --> 1-tailed test
C
C     N = degrees of freedom
C
C     Table entered from Table B.3 in appendix of JH Zar (1984)
C     Biostatistical Analysis, pp 484-485.
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
      SUBROUTINE TTABLE(T,P,N,TWOTAIL,RETURNP)
C
      REAL*4     T        ! t value
      REAL*4     P        ! probability of t
      INTEGER*4  N        ! degrees of freedom (nu)
      LOGICAL*1  TWOTAIL  ! true--> 2-tailed test
      LOGICAL*1  RETURNP  ! true--> return P for given T
C                         ; false-> return T for given P
C
      REAL*4     TOL      ! tolerance for match of probability
      INTEGER*4  NU       ! local degrees of freedom
C
      REAL*4     C(100,9) ! table of critical values of t for
C                           N=1,100 and 9 different 1-tailed p
      REAL*4     PROB(9)  ! 9 different 1-tailed probabilities
      CHARACTER*256 RCSHEADER
C
C
      DATA TOL  /.00001/
      DATA PROB /.25,.10,.05,.025,.01,.005,.0025,.001,.0005/
C
      DATA (C(1,I),I=1,9)
     &     /1.000,3.078,6.314,12.71,31.82,63.66,127.3,318.3,636.6/
      DATA (C(2,I),I=1,9)
     &     /0.816,1.886,2.920,4.303,6.965,9.925,14.09,22.33,31.60/
      DATA (C(3,I),I=1,9)
     &     /0.765,1.638,2.353,3.182,4.541,5.841,7.453,10.22,12.92/
      DATA (C(4,I),I=1,9)
     &     /0.741,1.533,2.132,2.776,3.747,4.604,5.598,7.173,8.610/
      DATA (C(5,I),I=1,9)
     &     /0.727,1.533,2.132,2.776,3.747,4.604,5.598,7.173,8.610/
C
      DATA (C(6,I),I=1,9)
     &     /0.718,1.440,1.943,2.447,3.143,3.707,4.317,5.208,5.959/
      DATA (C(7,I),I=1,9)
     &     /0.711,1.415,1.895,2.365,2.998,3.499,4.029,4.785,5.408/
      DATA (C(8,I),I=1,9)
     &     /0.706,1.397,1.860,2.306,2.896,3.355,3.833,4.501,5.041/
      DATA (C(9,I),I=1,9)
     &     /0.703,1.383,1.833,2.262,2.821,3.250,3.690,4.297,4.781/
      DATA (C(10,I),I=1,9)
     &     /0.700,1.372,1.812,2.228,2.764,3.169,3.581,4.144,4.587/
C
      DATA (C(11,I),I=1,9)
     &     /0.697,1.363,1.796,2.201,2.718,3.106,3.497,4.025,4.437/
      DATA (C(12,I),I=1,9)
     &     /0.695,1.356,1.782,2.179,2.681,3.055,3.428,3.930,4.318/
      DATA (C(13,I),I=1,9)
     &     /0.694,1.350,1.771,2.160,2.650,3.012,3.372,3.852,4.221/
      DATA (C(14,I),I=1,9)
     &     /0.692,1.345,1.761,2.145,2.624,2.977,3.326,3.787,4.140/
      DATA (C(15,I),I=1,9)
     &     /0.691,1.341,1.753,2.131,2.602,2.947,3.286,3.733,4.073/
C
      DATA (C(16,I),I=1,9)
     &     /0.690,1.337,1.746,2.120,2.583,2.921,3.252,3.686,4.015/
      DATA (C(17,I),I=1,9)
     &     /0.689,1.333,1.740,2.110,2.567,2.898,3.222,3.646,3.965/
      DATA (C(18,I),I=1,9)
     &     /0.688,1.330,1.734,2.101,2.552,2.878,3.197,3.610,3.922/
      DATA (C(19,I),I=1,9)
     &     /0.688,1.328,1.729,2.093,2.539,2.861,3.174,3.579,3.883/
      DATA (C(20,I),I=1,9)
     &     /0.687,1.325,1.725,2.086,2.528,2.845,3.153,3.552,3.850/
C
      DATA (C(21,I),I=1,9)
     &     /0.686,1.323,1.721,2.080,2.518,2.831,3.135,3.527,3.189/
      DATA (C(22,I),I=1,9)
     &     /0.686,1.321,1.717,2.074,2.508,2.819,3.119,3.505,3.792/
      DATA (C(23,I),I=1,9)
     &     /0.685,1.319,1.714,2.069,2.500,2.807,3.104,3.485,3.768/
      DATA (C(24,I),I=1,9)
     &     /0.685,1.318,1.711,2.064,2.492,2.797,3.091,3.467,3.745/
      DATA (C(25,I),I=1,9)
     &     /0.684,1.306,1.708,2.060,2.485,2.787,3.078,3.450,3.725/
C
      DATA (C(26,I),I=1,9)
     &     /0.684,1.315,1.706,2.056,2.479,2.779,3.067,3.435,3.707/
      DATA (C(27,I),I=1,9)
     &     /0.684,1.314,1.703,2.052,2.473,2.771,3.057,3.421,3.690/
      DATA (C(28,I),I=1,9)
     &     /0.683,1.313,1.701,2.048,2.467,2.763,3.047,3.408,3.674/
      DATA (C(29,I),I=1,9)
     &     /0.683,1.311,1.669,2.045,2.462,2.756,3.038,3.396,3.659/
      DATA (C(30,I),I=1,9)
     &     /0.683,1.310,1.697,2.042,2.457,2.750,3.030,3.385,3.646/
C
      DATA (C(31,I),I=1,9)
     &     /0.682,1.309,1.696,2.040,2.453,2.744,3.022,3.375,3.633/
      DATA (C(32,I),I=1,9)
     &     /0.682,1.309,1.694,2.037,2.449,2.738,3.015,3.365,3.622/
      DATA (C(33,I),I=1,9)
     &     /0.682,1.308,1.692,2.035,2.445,2.733,3.008,3.356,3.611/
      DATA (C(34,I),I=1,9)
     &     /0.682,1.307,1.691,2.032,2.441,2.728,3.002,3.348,3.601/
      DATA (C(35,I),I=1,9)
     &     /0.682,1.306,1.690,2.030,2.438,2.724,2.996,3.340,3.591/
C
      DATA (C(36,I),I=1,9)
     &     /0.681,1.306,1.688,2.028,2.434,2.719,2.990,3.333,3.582/
      DATA (C(37,I),I=1,9)
     &     /0.681,1.305,1.687,2.026,2.431,2.715,2.989,3.326,3.574/
      DATA (C(38,I),I=1,9)
     &     /0.681,1.304,1.686,2.024,2.429,2.712,2.980,3.319,3.566/
      DATA (C(39,I),I=1,9)
     &     /0.681,1.304,1.685,2.023,2.426,2.708,2.976,3.313,3.558/
      DATA (C(40,I),I=1,9)
     &     /0.681,1.303,1.684,2.021,2.423,2.704,2.971,3.307,3.551/
C
      DATA (C(41,I),I=1,9)
     &     /0.681,1.303,1.683,2.020,2.421,2.701,2.967,3.301,3.544/
      DATA (C(42,I),I=1,9)
     &     /0.680,1.302,1.682,2.018,2.418,2.698,2.936,3.296,3.538/
      DATA (C(43,I),I=1,9)
     &     /0.680,1.302,1.681,2.017,2.416,2.695,2.959,3.291,3.532/
      DATA (C(44,I),I=1,9)
     &     /0.680,1.301,1.680,2.015,2.414,2.692,2.956,3.286,3.526/
      DATA (C(45,I),I=1,9)
     &     /0.680,1.301,1.679,2.014,2.412,2.690,2.952,3.281,3.520/
C
      DATA (C(46,I),I=1,9)
     &     /0.680,1.300,1.679,2.013,2.410,2.687,2.949,3.277,3.515/
      DATA (C(47,I),I=1,9)
     &     /0.680,1.300,1.678,2.012,2.408,2.685,2.946,3.273,3.510/
      DATA (C(48,I),I=1,9)
     &     /0.680,1.299,1.677,2.011,2.407,2.682,2.943,3.269,3.505/
      DATA (C(49,I),I=1,9)
     &     /0.680,1.299,1.677,2.010,2.405,2.680,2.940,3.265,3.500/
      DATA (C(50,I),I=1,9)
     &     /0.679,1.299,1.676,2.009,2.403,2.678,2.937,3.261,3.496/
C
      DATA (C(51,I),I=1,9)
     &     /0.679,1.299,1.676,2.008,2.402,2.676,2.935,3.258,3.492/
      DATA (C(52,I),I=1,9)
     &     /0.679,1.298,1.675,2.007,2.400,2.674,2.932,3.255,3.488/
      DATA (C(53,I),I=1,9)
     &     /0.679,1.298,1.675,2.006,2.399,2.672,2.930,3.252,3.484/
      DATA (C(54,I),I=1,9)
     &     /0.679,1.297,1.674,2.005,2.397,2.670,2.927,3.248,3.480/
      DATA (C(55,I),I=1,9)
     &     /0.679,1.297,1.673,2.004,2.396,2.669,2.925,3.245,3.477/
C
      DATA (C(56,I),I=1,9)
     &     /0.679,1.297,1.673,2.003,2.395,2.667,2.923,3.242,3.473/
      DATA (C(57,I),I=1,9)
     &     /0.679,1.297,1.673,2.003,2.394,2.665,2.921,3.240,3.470/
      DATA (C(58,I),I=1,9)
     &     /0.679,1.296,1.672,2.002,2.392,2.663,2.918,3.237,3.466/
      DATA (C(59,I),I=1,9)
     &     /0.679,1.296,1.672,2.001,2.391,2.662,2.917,3.235,3.463/
      DATA (C(60,I),I=1,9)
     &     /0.679,1.296,1.671,2.000,2.390,2.660,2.915,3.232,3.460/
C
      DATA (C(61,I),I=1,9)
     &     /0.679,1.296,1.671,2.000,2.389,2.659,2.913,3.230,3.457/
      DATA (C(62,I),I=1,9)
     &     /0.678,1.295,1.670,1.999,2.388,2.657,2.911,3.227,3.454/
      DATA (C(63,I),I=1,9)
     &     /0.678,1.295,1.670,1.999,2.387,2.656,2.910,3.225,3.452/
      DATA (C(64,I),I=1,9)
     &     /0.678,1.295,1.669,1.998,2.386,2.655,2.908,3.223,3.449/
      DATA (C(65,I),I=1,9)
     &     /0.678,1.295,1.669,1.998,2.385,2.654,2.906,3.221,3.447/
C
      DATA (C(66,I),I=1,9)
     &     /0.678,1.295,1.668,1.997,2.384,2.652,2.904,3.218,3.444/
      DATA (C(67,I),I=1,9)
     &     /0.678,1.295,1.668,1.996,2.383,2.651,2.903,3.216,3.442/
      DATA (C(68,I),I=1,9)
     &     /0.678,1.294,1.668,1.995,2.382,2.650,2.902,3.214,3.439/
      DATA (C(69,I),I=1,9)
     &     /0.678,1.294,1.668,1.995,2.382,2.649,2.901,3.213,3.437/
      DATA (C(70,I),I=1,9)
     &     /0.678,1.294,1.667,1.994,2.381,2.648,2.899,3.211,3.435/
C
      DATA (C(71,I),I=1,9)
     &     /0.678,1.294,1.667,1.994,2.380,2.647,2.898,3.209,3.433/
      DATA (C(72,I),I=1,9)
     &     /0.678,1.293,1.676,1.993,2.379,2.646,2.896,3.207,3.431/
      DATA (C(73,I),I=1,9)
     &     /0.678,1.293,1.676,1.993,2.379,2.645,2.895,3.206,3.429/
      DATA (C(74,I),I=1,9)
     &     /0.678,1.293,1.676,1.993,2.378,2.644,2.894,3.204,3.427/
      DATA (C(75,I),I=1,9)
     &     /0.678,1.293,1.676,1.993,2.377,2.643,2.893,3.203,3.425/
C
      DATA (C(76,I),I=1,9)
     &     /0.678,1.293,1.675,1.992,2.376,2.642,2.891,3.201,3.423/
      DATA (C(77,I),I=1,9)
     &     /0.678,1.293,1.675,1.992,2.376,2.641,2.890,3.200,3.422/
      DATA (C(78,I),I=1,9)
     &     /0.678,1.292,1.675,1.991,2.375,2.640,2.889,3.198,3.420/
      DATA (C(79,I),I=1,9)
     &     /0.678,1.292,1.675,1.991,2.375,2.640,2.888,3.197,3.418/
      DATA (C(80,I),I=1,9)
     &     /0.678,1.292,1.674,1.990,2.374,2.639,2.887,3.195,3.416/
C
      DATA (C(81,I),I=1,9)
     &     /0.678,1.292,1.674,1.990,2.374,2.638,2.886,3.194,3.415/
      DATA (C(82,I),I=1,9)
     &     /0.677,1.292,1.674,1.989,2.373,2.637,2.885,3.193,3.413/
      DATA (C(83,I),I=1,9)
     &     /0.677,1.292,1.674,1.989,2.373,2.637,2.884,3.192,3.412/
      DATA (C(84,I),I=1,9)
     &     /0.677,1.292,1.673,1.989,2.372,2.636,2.883,3.190,3.410/
      DATA (C(85,I),I=1,9)
     &     /0.677,1.292,1.673,1.989,2.371,2.635,2.882,3.189,3.409/
C
      DATA (C(86,I),I=1,9)
     &     /0.677,1.291,1.673,1.988,2.370,2.634,2.881,3.188,3.407/
      DATA (C(87,I),I=1,9)
     &     /0.677,1.291,1.673,1.988,2.370,2.634,2.881,3.187,3.406/
      DATA (C(88,I),I=1,9)
     &     /0.677,1.291,1.672,1.987,2.369,2.633,2.880,3.185,3.405/
      DATA (C(89,I),I=1,9)
     &     /0.677,1.291,1.672,1.987,2.369,2.633,2.879,3.184,3.404/
      DATA (C(90,I),I=1,9)
     &     /0.677,1.291,1.672,1.987,2.368,2.632,2.878,3.183,3.402/
C
      DATA (C(91,I),I=1,9)
     &     /0.677,1.291,1.672,1.987,2.368,2.631,2.877,3.182,3.401/
      DATA (C(92,I),I=1,9)
     &     /0.677,1.291,1.672,1.986,2.368,2.630,2.876,3.181,3.399/
      DATA (C(93,I),I=1,9)
     &     /0.677,1.291,1.672,1.986,2.368,2.630,2.876,3.180,3.398/
      DATA (C(94,I),I=1,9)
     &     /0.677,1.291,1.671,1.986,2.367,2.629,2.875,3.179,3.397/
      DATA (C(95,I),I=1,9)
     &     /0.677,1.291,1.671,1.986,2.367,2.629,2.874,3.178,3.396/
C
      DATA (C(96,I),I=1,9)
     &     /0.677,1.290,1.671,1.985,2.366,2.628,2.873,3.177,3.395/
      DATA (C(97,I),I=1,9)
     &     /0.677,1.290,1.671,1.985,2.366,2.628,2.873,3.176,3.394/
      DATA (C(98,I),I=1,9)
     &     /0.677,1.290,1.671,1.984,2.365,2.627,2.872,3.175,3.393/
      DATA (C(99,I),I=1,9)
     &     /0.677,1.290,1.671,1.984,2.365,2.627,2.872,3.175,3.392/
      DATA (C(100,I),I=1,9)
     &     /0.677,1.290,1.670,1.984,2.364,2.626,2.871,3.174,3.390/
C
C  Given T, find upper bound on probability P
C  (Tables are for 1-tailed probabilities)
      RCSHEADER = '$Id$'
C
      IF (RETURNP) THEN
        IF (N.GT.100) THEN
          NU = 100
        ELSE
          NU = N
        END IF
        P = 1.0
        DO 100 I=1,9
          IF (ABS(T).GE.C(NU,I)) P = PROB(I)
100     CONTINUE
        IF (TWOTAIL) P = 2.0*P
C
C  Given P, find critical T
C  (Tables are for 1-tailed probabilities)
C
      ELSE
        IF (N.GT.100) THEN
          NU = 100
        ELSE
          NU = N
        END IF
        T = 1.0
        IF (TWOTAIL) THEN
          DO 300 I=1,9
            IF (P-TOL .LE. 2.0*PROB(I)) T = C(NU,I)
300       CONTINUE
        ELSE
          DO 400 I=1,9
            IF (P-TOL .LE. PROB(I)) T = C(NU,I)
400       CONTINUE
        END IF
      END IF
C
      RETURN
      END
@
