head	1.1;
access;
symbols;
locks; strict;
comment	@c @;


1.1
date	93.11.17.20.29.12;	author ty7777;	state Exp;
branches;
next	;


desc
@X window version, first release.
@


1.1
log
@Initial revision
@
text
@C$Id$
C$Log$
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
C  Subroutine:   ZTABLE.FTN
C
C  Author:       Tom O. Videen
C  Date:         11-Jul-90
C  Written For:  RAPTURE
C
C  History:
C     Modified 17-Nov-93 by Tom Yang to port to UNIX workstations.
C
C  Intent:
C     When RETURNP this subroutine returns the integral of all P
C        less than Z;
C     When .NOT.RETURNP this subroutine returns the Z for which
C        F(Z) >= P;
C
C     Table entered from Normal Distribution Table of CRC Handbook
C     of Tables for Probability and Statistics, 2nd Edition.
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
      SUBROUTINE ZTABLE(Z,P,RETURNP)
C
      REAL*4     Z        ! z value
      REAL*4     P        ! probability of value <= Z
      LOGICAL*1  RETURNP  ! true--> return P for given Z
C
      REAL*4     F(400)   ! table of integeral of values less than Z
      REAL*4     NP       ! 1-P to locate negative Z
C
      INTEGER*4  NZ       ! 100*Z used as index to table
      CHARACTER*256 RCSHEADER
C
C
      DATA (F(I),I=1,10)
     &  /.5040,.5080,.5120,.5160,.5199,.5239,.5279,.5319,.5359,.5398/
      DATA (F(I),I=11,20)
     &  /.5438,.5478,.5517,.5557,.5596,.5636,.5675,.5714,.5753,.5793/
      DATA (F(I),I=21,30)
     &  /.5832,.5871,.5910,.5948,.5987,.6026,.6064,.6103,.6141,.6179/
      DATA (F(I),I=31,40)
     &  /.6217,.6255,.6293,.6331,.6368,.6406,.6443,.6480,.6517,.6554/
      DATA (F(I),I=41,50)
     &  /.6591,.6628,.6664,.6700,.6736,.6772,.6808,.6844,.6879,.6915/
      DATA (F(I),I=51,60)
     &  /.6950,.6985,.7019,.7054,.7088,.7123,.7157,.7190,.7224,.7257/
      DATA (F(I),I=61,70)
     &  /.7291,.7324,.7357,.7389,.7422,.7454,.7486,.7517,.7549,.7580/
      DATA (F(I),I=71,80)
     &  /.7611,.7642,.7673,.7704,.7737,.7764,.7794,.7823,.7852,.7881/
      DATA (F(I),I=81,90)
     &  /.7910,.7939,.7967,.7995,.8023,.8051,.8078,.8106,.8133,.8159/
      DATA (F(I),I=91,100)
     &  /.8186,.8212,.8238,.8264,.8289,.8315,.8340,.8365,.8389,.8413/
C
      DATA (F(I),I=101,110)
     &  /.8438,.8461,.8485,.8508,.8531,.8554,.8577,.8599,.8621,.8643/
      DATA (F(I),I=111,120)
     &  /.8665,.8686,.8708,.8729,.8749,.8770,.8790,.8810,.8830,.8849/
      DATA (F(I),I=121,130)
     &  /.8869,.8888,.8907,.8925,.8944,.8962,.8980,.8997,.9015,.9032/
      DATA (F(I),I=131,140)
     &  /.9049,.9066,.9082,.9099,.9115,.9131,.9147,.9162,.9177,.9192/
      DATA (F(I),I=141,150)
     &  /.9207,.9222,.9236,.9251,.9265,.9279,.9292,.9306,.9319,.9332/
      DATA (F(I),I=151,160)
     &  /.9345,.9357,.9370,.9382,.9394,.9406,.9418,.9429,.9441,.9452/
      DATA (F(I),I=161,170)
     &  /.9463,.9474,.9484,.9495,.9505,.9515,.9525,.9535,.9545,.9554/
      DATA (F(I),I=171,180)
     &  /.9564,.9573,.9582,.9591,.9599,.9608,.9616,.9625,.9633,.9641/
      DATA (F(I),I=181,190)
     &  /.9649,.9656,.9664,.9671,.9678,.9686,.9693,.9699,.9706,.9713/
      DATA (F(I),I=191,200)
     &  /.9719,.9726,.9732,.9738,.9744,.9750,.9756,.9761,.9767,.9773/
C
      DATA (F(I),I=201,210)
     &  /.9778,.9783,.9788,.9793,.9798,.9803,.9808,.9812,.9817,.9821/
      DATA (F(I),I=211,220)
     &  /.9826,.9830,.9834,.9838,.9842,.9846,.9850,.9854,.9857,.9861/
      DATA (F(I),I=221,230)
     &  /.9864,.9868,.9871,.9875,.9878,.9881,.9884,.9887,.9890,.9893/
      DATA (F(I),I=231,240)
     &  /.9896,.9898,.9901,.9904,.9906,.9909,.9911,.9913,.9916,.9918/
      DATA (F(I),I=241,250)
     &  /.9920,.9922,.9925,.9927,.9929,.9931,.9932,.9934,.9936,.9938/
      DATA (F(I),I=251,260)
     &  /.9940,.9941,.9943,.9945,.9946,.9948,.9949,.9951,.9952,.9953/
      DATA (F(I),I=261,270)
     &  /.9955,.9956,.9957,.9959,.9960,.9961,.9962,.9963,.9964,.9965/
      DATA (F(I),I=271,280)
     &  /.9966,.9967,.9968,.9969,.9970,.9971,.9972,.9973,.9974,.9974/
      DATA (F(I),I=281,290)
     &  /.9975,.9976,.9977,.9977,.9978,.9979,.9979,.9980,.9981,.9981/
      DATA (F(I),I=291,300)
     &  /.9982,.9982,.9983,.9984,.9984,.9985,.9985,.9986,.9986,.9987/
C
      DATA (F(I),I=301,310)
     &  /.9987,.9987,.9988,.9988,.9989,.9989,.9989,.9990,.9990,.9990/
      DATA (F(I),I=311,320)
     &  /.9991,.9991,.9991,.9992,.9992,.9992,.9992,.9993,.9993,.9993/
      DATA (F(I),I=321,330)
     &  /.9993,.9994,.9994,.9994,.9994,.9994,.9995,.9995,.9995,.9995/
      DATA (F(I),I=331,340)
     &  /.9995,.9995,.9996,.9996,.9996,.9996,.9996,.9996,.9997,.9997/
      DATA (F(I),I=341,350)
     &  /.9997,.9997,.9997,.9997,.9997,.9997,.9997,.9997,.9998,.9998/
      DATA (F(I),I=351,360)
     &  /.9998,.9998,.9998,.9998,.9998,.9998,.9998,.9998,.9998,.9998/
      DATA (F(I),I=361,370)
     &  /.9998,.9999,.9999,.9999,.9999,.9999,.9999,.9999,.9999,.9999/
      DATA (F(I),I=371,380)
     &  /.9999,.9999,.9999,.9999,.9999,.9999,.9999,.9999,.9999,.9999/
      DATA (F(I),I=381,390)
     &  /.9999,.9999,.9999,.9999,.9999,.9999,.9999,.9999,.9999,1.000/
      DATA (F(I),I=391,400)
     &  /1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000/
C
C  Get P given Z
      RCSHEADER = '$Id$'
C
      IF (RETURNP) THEN
        IF (Z.GT.4.0) THEN
          P = 1.0
        ELSE IF (Z.LT.-4.0) THEN
          P = 0.0
        ELSE IF (Z.GT.0.0) THEN
          NZ = NINT(Z*100.)
          P = F(NZ)
        ELSE IF (Z.LT.0.0) THEN
          NZ = NINT(-Z*100.)
          P = 1.0 - F(NZ)
        ELSE IF (Z.EQ.0.0) THEN
          P = 0.5
        END IF
C
C  Get Z given P
C
      ELSE
        IF (P.GE.1.0) THEN
          Z = 3.9
        ELSE IF (P.LE.0.0) THEN
          Z = -3.9
        ELSE IF (P.EQ.0.5) THEN
          Z = 0.0
        ELSE IF (P.GT.0.5) THEN
          DO 100 I=1,400
            IF (P.GT.F(I)) THEN
              Z = FLOAT(I)*.01
              RETURN
            END IF
100       CONTINUE
        ELSE IF (P.LT.0.5) THEN
          NP = (1.0 - P)
          DO 200 I=1,400
            IF (NP.GT.F(I)) THEN
              Z = FLOAT(-I)*.01
              RETURN
            END IF
200       CONTINUE
        END IF
      END IF
C
      RETURN
      END
@
