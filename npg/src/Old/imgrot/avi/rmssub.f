      SUBROUTINE F128100(IMG,ARES)
      INTEGER*2 IMG(128,128),ARES(100,100)
      DO 1 I=1,100
      DO 1 J=1,100
    1 ARES(I,J)=IMG(I+14,J+14)
      RETURN
      END
      SUBROUTINE RMSMSK(ATTEN,IMAGE)
      INTEGER*2 ATTEN(100,100),IMAGE(100,100)
      DO 1 I=1,100
      DO 1 J=1,100
      IF(ATTEN(I,J).EQ.0)IMAGE(I,J)=0
    1 CONTINUE
      RETURN
      END
      SUBROUTINE RMSSUM(ATTEN,IMAGE,SUM0,SUM2,SUML,KMAX,KPIX)
      INTEGER*2 ATTEN(100,100),IMAGE(100,100)
      DO 1 I=2,99
      DO 1 J=2,99
      IF(ATTEN(I,J).GT.0)THEN
      SUM0=SUM0+FLOAT(IMAGE(I,J))
      SUM2=SUM2+FLOAT(IMAGE(I,J))**2
      SUML=SUML+(       FLOAT(IMAGE(I  ,J))
     &           -.25*( FLOAT(IMAGE(I+1,J))+FLOAT(IMAGE(I-1,J))
     &                 +FLOAT(IMAGE(I,J+1))+FLOAT(IMAGE(I,J-1))))**2
      KMAX=MAX0(KMAX,IMAGE(I,J))
      KPIX=KPIX+1
      ENDIF
    1 CONTINUE
      RETURN
      END
      SUBROUTINE RMSDX(IMAGE,GRADI)
      INTEGER*2 IMAGE(100,100),GRADI(100,100)
      DO 1 J=1,100
      DO 2 I=2,99
    2 GRADI(I,J)=.5*(IMAGE(I+1,J)-IMAGE(I-1,J))
      GRADI(1,J)=0
    1 GRADI(100,J)=0
      RETURN
      END
      SUBROUTINE RMSSMO(IMAGE,IMAG1)
      INTEGER*2 IMAGE(100,100),IMAG1(100,100)
      DO 1 J=1,100
      DO 1 I=2,99
    1 IMAG1(I,J)=INT2(.25*(FLOAT(IMAGE(I-1,J))+FLOAT(IMAGE(I+1,J)))
     &               +.50*FLOAT(IMAGE(I,J)))
      DO 2 I=1,100
      DO 2 J=2,99
    2 IMAGE(I,J)=INT2(.25*(FLOAT(IMAG1(I,J-1))+FLOAT(IMAG1(I,J+1)))
     &               +.50*FLOAT(IMAG1(I,J)))
      RETURN
      END
      SUBROUTINE RMSDY(IMAGE,GRADI)
      INTEGER*2 IMAGE(100,100),GRADI(100,100)
      DO 1 I=1,100
      DO 2 J=2,99
    2 GRADI(I,J)=.5*(IMAGE(I,J+1)-IMAGE(I,J-1))
      GRADI(I,1)=0
    1 GRADI(I,100)=0
      RETURN
      END
      SUBROUTINE RMSPRO(ATTEN,DIFIM,GRADI,PROD,ANRM)
      INTEGER*2 ATTEN(100,100),DIFIM(100,100),GRADI(100,100)
      DO 1 I=1,100
      DO 1 J=1,100
      IF(ATTEN(I,J).GT.0)THEN
      PROD=PROD+FLOAT(GRADI(I,J))*FLOAT(DIFIM(I,J))
      ANRM=ANRM+FLOAT(GRADI(I,J))*FLOAT(GRADI(I,J))
      ENDIF
    1 CONTINUE
      RETURN
      END
