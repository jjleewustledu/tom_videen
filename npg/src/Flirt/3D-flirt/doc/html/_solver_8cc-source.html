<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>flirt: Solver.cc Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.1 -->
<div class="qindex">  <form class="search" action="search.php" method="get">
<a class="qindex" href="main.html">Main&nbsp;Page</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="annotated.html">Data&nbsp;Structures</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Data&nbsp;Fields</a> | <a class="qindex" href="globals.html">Globals</a>  | <span class="search"><u>S</u>earch&nbsp;for&nbsp;<input class="search" type="text" name="query" value="" size="20" accesskey="s"/></span></form></div>
<div class="nav">
<a class="el" href="dir_000000.html">home</a>&nbsp;/&nbsp;<a class="el" href="dir_000001.html">ens</a>&nbsp;/&nbsp;<a class="el" href="dir_000002.html">flirtproj</a>&nbsp;/&nbsp;<a class="el" href="dir_000003.html">flirt++</a></div>
<h1>Solver.cc</h1><div class="fragment"><pre class="fragment">00001 <span class="preprocessor">#include "Solver.h"</span>
00002 
00003 <span class="keyword">namespace </span>flirt {
00004   <span class="comment">// ---------------------------------------------------------------------</span>
00005   <span class="comment">// TMSolverDiffusiveAOS2D</span>
00006   <span class="comment">//----------------------------------------------------------------------</span>
00007   TMSolverDiffusiveAOS2D :: TMSolverDiffusiveAOS2D(){
00008     diffMatrix = NULL;
00009     bc = <a class="code" href="defs_8h.html#a8a4">NEUMANN</a>;
00010   };
00011 
00012 <span class="comment">//-----------------------------------------------------------------------</span>
00013   TMSolverDiffusiveAOS2D :: TMSolverDiffusiveAOS2D( <span class="keyword">const</span> Displacement2D&amp; u, <span class="keywordtype">double</span> _alpha, <span class="keywordtype">double</span> _tau)
00014     : ans( &amp;u.getDimensions()[1], u.getVoxelSize()), rhs( &amp;
00015       u.getDimensions()[1], u.getVoxelSize()){
00016 
00017     diffMatrix = NULL;
00018     bc = <a class="code" href="defs_8h.html#a8a4">NEUMANN</a>;
00019 
00020     initDiffusivePlan2D(rhs.getDimensions()[2],
00021                         rhs.getDimensions()[1],
00022                         alpha,
00023                         tau,
00024                         rhs.getVoxelSize()[1],
00025                         rhs.getVoxelSize()[0],
00026                         bc,
00027                         &amp;diffMatrix);
00028 
00029   };
00030 
00031   <span class="comment">// ---------------------------------------------------------------------</span>
00032   TMSolverDiffusiveAOS2D :: ~TMSolverDiffusiveAOS2D() {
00033     deleteDiffusivePlan(diffMatrix);
00034   };  
00035 
00036  <span class="comment">//-----------------------------------------------------------------------</span>
00037   <span class="keywordtype">void</span> TMSolverDiffusiveAOS2D :: solve() {
00038     solveDiffusive2D(diffMatrix,
00039                      rhs.getArray()[0],
00040                      ans.getArray()[0]);
00041         
00042     solveDiffusive2D(diffMatrix,
00043                      rhs.getArray()[1],
00044                      ans.getArray()[1]);
00045         
00046   };
00047 
00048   <span class="comment">// ---------------------------------------------------------------------</span>
00049   Array&amp; TMSolverDiffusiveAOS2D :: getAns() {
00050     <span class="keywordflow">return</span> ans;
00051   };
00052 
00053 
00054   <span class="comment">// ---------------------------------------------------------------------</span>
00055   Array&amp; TMSolverDiffusiveAOS2D :: getRhs() {
00056     <span class="keywordflow">return</span> rhs;
00057   };
00058 
00059 
00060   <span class="comment">// ---------------------------------------------------------------------</span>
00061   <span class="comment">// TMSolverDiffusiveFFT2D</span>
00062   <span class="comment">// ---------------------------------------------------------------------</span>
00063   TMSolverDiffusiveFFT2D :: TMSolverDiffusiveFFT2D() {
00064     plan = NULL;
00065     bc   = <a class="code" href="defs_8h.html#a8a4">NEUMANN</a>;
00066     gs   = <a class="code" href="defs_8h.html#a9a6">GRIDPOINT</a>;
00067   };  
00068   <span class="comment">// ---------------------------------------------------------------------</span>
00069 
00070   TMSolverDiffusiveFFT2D :: TMSolverDiffusiveFFT2D( <span class="keyword">const</span> Displacement2D&amp; u, <span class="keywordtype">double</span> _alpha, <span class="keywordtype">double</span> _tau)
00071     : ans( &amp;u.getDimensions()[1], u.getVoxelSize()), rhs( &amp;
00072       u.getDimensions()[1], u.getVoxelSize()){
00073 
00074     bc   = <a class="code" href="defs_8h.html#a8a4">NEUMANN</a>;
00075     gs   = <a class="code" href="defs_8h.html#a9a6">GRIDPOINT</a>;
00076     alpha = _alpha;
00077     tau = _tau; 
00078 
00079     plan = createDeltaPlan2D(u.getDimensions()[1],
00080                              u.getDimensions()[2],
00081                              u.getVoxelSize()[0],
00082                              u.getVoxelSize()[1],
00083                              bc,
00084                              gs);
00085 
00086   };  
00087 
00088 
00089   <span class="comment">// ---------------------------------------------------------------------</span>
00090   TMSolverDiffusiveFFT2D :: ~TMSolverDiffusiveFFT2D() {
00091     deleteDeltaPlan(plan);
00092   };  
00093 
00094   <span class="comment">// ---------------------------------------------------------------------</span>
00095   <span class="keywordtype">void</span> TMSolverDiffusiveFFT2D :: solve() {
00096     solveDelta(plan,1.0, -tau*alpha, rhs.getArray()[0][0], ans.getArray()[0][0]);
00097     solveDelta(plan,1.0, -tau*alpha, rhs.getArray()[1][0], ans.getArray()[1][0]);
00098   };
00099 
00100 
00101   <span class="comment">// ---------------------------------------------------------------------</span>
00102   Array&amp; TMSolverDiffusiveFFT2D :: getAns() {
00103     <span class="keywordflow">return</span> ans;
00104   };
00105 
00106 
00107   <span class="comment">// ---------------------------------------------------------------------</span>
00108   Array&amp; TMSolverDiffusiveFFT2D :: getRhs() {
00109     <span class="keywordflow">return</span> rhs;
00110   };
00111 
00112 
00113   <span class="comment">// ---------------------------------------------------------------------</span>
00114   <span class="comment">// TMSolverCurvatureFFT2D</span>
00115   <span class="comment">// ---------------------------------------------------------------------</span>
00116   TMSolverCurvatureFFT2D :: TMSolverCurvatureFFT2D() {
00117     plan = NULL;
00118     bc   = <a class="code" href="defs_8h.html#a8a4">NEUMANN</a>;
00119     gs   = <a class="code" href="defs_8h.html#a9a6">GRIDPOINT</a>;
00120   };  
00121 <span class="comment">// ---------------------------------------------------------------------</span>
00122 
00123   TMSolverCurvatureFFT2D :: TMSolverCurvatureFFT2D( <span class="keyword">const</span> Displacement2D&amp; u, <span class="keywordtype">double</span> _alpha, <span class="keywordtype">double</span> _tau)
00124     : ans( &amp;u.getDimensions()[1], u.getVoxelSize()), rhs( &amp;
00125       u.getDimensions()[1], u.getVoxelSize()){
00126 
00127     bc   = <a class="code" href="defs_8h.html#a8a4">NEUMANN</a>;
00128     gs   = <a class="code" href="defs_8h.html#a9a6">GRIDPOINT</a>;
00129     alpha = _alpha;
00130     tau = _tau; 
00131 
00132     plan = createDeltaPlan2D(u.getDimensions()[1],
00133                              u.getDimensions()[2],
00134                              u.getVoxelSize()[0],
00135                              u.getVoxelSize()[1],
00136                              bc,
00137                              gs);
00138 
00139   };  
00140 
00141 
00142   <span class="comment">// ---------------------------------------------------------------------</span>
00143   TMSolverCurvatureFFT2D :: ~TMSolverCurvatureFFT2D() {
00144     deleteDeltaPlan(plan);
00145   };  
00146 
00147  
00148   <span class="comment">// ---------------------------------------------------------------------</span>
00149   <span class="keywordtype">void</span> TMSolverCurvatureFFT2D :: solve() {
00150     solveCurvature(plan,1.0, tau*alpha, rhs.getArray()[0][0], ans.getArray()[0][0]);
00151     solveCurvature(plan,1.0, tau*alpha, rhs.getArray()[1][0], ans.getArray()[1][0]);
00152   };
00153 
00154 
00155   <span class="comment">// ---------------------------------------------------------------------</span>
00156   Array&amp; TMSolverCurvatureFFT2D :: getAns() {
00157     <span class="keywordflow">return</span> ans;
00158   };
00159 
00160 
00161   <span class="comment">// ---------------------------------------------------------------------</span>
00162   Array&amp; TMSolverCurvatureFFT2D :: getRhs() {
00163     <span class="keywordflow">return</span> rhs;
00164   };
00165 
00166 
00167 
00168 
00169   <span class="comment">// ---------------------------------------------------------------------</span>
00170   <span class="comment">// ---------------------------------------------------------------------</span>
00171   <span class="comment">// ---------------------------------------------------------------------</span>
00172   <span class="comment">// ---------------------------------------------------------------------</span>
00173   <span class="comment">// ---------------------------------------------------------------------</span>
00174   <span class="comment">// FPSolverCurvatureFFT2D</span>
00175   <span class="comment">// ---------------------------------------------------------------------</span>
00176   <span class="comment">// ---------------------------------------------------------------------</span>
00177   <span class="comment">// ---------------------------------------------------------------------</span>
00178   <span class="comment">// ---------------------------------------------------------------------</span>
00179   <span class="comment">// ---------------------------------------------------------------------</span>
00180   <span class="comment">// ---------------------------------------------------------------------</span>
00181   <span class="comment">// ---------------------------------------------------------------------</span>
00182   FPSolverCurvatureFFT2D :: FPSolverCurvatureFFT2D() {
00183     plan = NULL;
00184     bc   = <a class="code" href="defs_8h.html#a8a4">NEUMANN</a>;
00185     gs   = <a class="code" href="defs_8h.html#a9a6">GRIDPOINT</a>;
00186   };  
00187 
00188   <span class="comment">// ---------------------------------------------------------------------</span>
00189   
00190   FPSolverCurvatureFFT2D :: FPSolverCurvatureFFT2D( <span class="keyword">const</span> Displacement2D&amp; u, <span class="keywordtype">double</span> _alpha)
00191     : ans( &amp;u.getDimensions()[1], u.getVoxelSize()), rhs( &amp;
00192       u.getDimensions()[1], u.getVoxelSize()){
00193     <span class="comment">//printf("Constructor FPSolverCurvatureFFT2D( const Displacement2&amp;)\n\n");</span>
00194     bc   = <a class="code" href="defs_8h.html#a8a4">NEUMANN</a>;
00195     gs   = <a class="code" href="defs_8h.html#a9a6">GRIDPOINT</a>;
00196      
00197     plan = createDeltaPlan2D(u.getDimensions()[1],
00198                              u.getDimensions()[2],
00199                              u.getVoxelSize()[0],
00200                              u.getVoxelSize()[1],
00201                              bc,
00202                              gs);
00203 
00204     alpha = _alpha;
00205     
00206   };  
00207   
00208   <span class="comment">// ---------------------------------------------------------------------</span>
00209   FPSolverCurvatureFFT2D :: ~FPSolverCurvatureFFT2D() {
00210     deleteDeltaPlan(plan);
00211   };  
00212 
00213   <span class="comment">// ---------------------------------------------------------------------</span>
00214   <span class="keywordtype">void</span> FPSolverCurvatureFFT2D :: solve() {
00215     solveCurvature(plan,0.0, alpha, rhs.getArray()[0][0], ans.getArray()[0][0]);
00216     solveCurvature(plan,0.0, alpha, rhs.getArray()[1][0], ans.getArray()[1][0]);
00217   };
00218 
00219 
00220   <span class="comment">// ---------------------------------------------------------------------</span>
00221   Array&amp; FPSolverCurvatureFFT2D :: getAns() {
00222     <span class="keywordflow">return</span> ans;
00223   };
00224 
00225 
00226   <span class="comment">// ---------------------------------------------------------------------</span>
00227   Array&amp; FPSolverCurvatureFFT2D :: getRhs() {
00228     <span class="keywordflow">return</span> rhs;
00229   };
00230 
00231 
00232 
00233   <span class="comment">// ---------------------------------------------------------------------</span>
00234   <span class="comment">// ---------------------------------------------------------------------</span>
00235   <span class="comment">// ---------------------------------------------------------------------</span>
00236   <span class="comment">// ---------------------------------------------------------------------</span>
00237   <span class="comment">// ---------------------------------------------------------------------</span>
00238   <span class="comment">// FPSolverElasticFFT2D</span>
00239   <span class="comment">// ---------------------------------------------------------------------</span>
00240   <span class="comment">// ---------------------------------------------------------------------</span>
00241   <span class="comment">// ---------------------------------------------------------------------</span>
00242   <span class="comment">// ---------------------------------------------------------------------</span>
00243   <span class="comment">// ---------------------------------------------------------------------</span>
00244   <span class="comment">// ---------------------------------------------------------------------</span>
00245   <span class="comment">// ---------------------------------------------------------------------</span>
00246   FPSolverElasticFFT2D :: FPSolverElasticFFT2D() {
00247     mu     = -1.0;
00248     lambda = -1.0;
00249     plan   = NULL;
00250     bc     = <a class="code" href="defs_8h.html#a8a5">PERIODIC</a>;
00251   };  
00252 
00253   <span class="comment">// ---------------------------------------------------------------------</span>
00254   FPSolverElasticFFT2D :: FPSolverElasticFFT2D( <span class="keyword">const</span> Displacement2D&amp; u, <span class="keywordtype">double</span> _alpha, <span class="keywordtype">double</span> _mu, <span class="keywordtype">double</span> _lambda)
00255     : ans( &amp;u.getDimensions()[1], u.getVoxelSize()), rhs( &amp;
00256       u.getDimensions()[1], u.getVoxelSize()){
00257 
00258     bc   = <a class="code" href="defs_8h.html#a8a5">PERIODIC</a>;
00259     alpha = _alpha;
00260     mu = _mu;
00261     lambda = _lambda;
00262 
00263     initElasticPlan2D(u.getDimensions()[1],
00264                       u.getDimensions()[2],
00265                       alpha,
00266                       mu,
00267                       lambda,
00268                       u.getVoxelSize()[0],
00269                       u.getVoxelSize()[1],
00270                       bc,
00271                       &amp;plan);
00272 
00273   };  
00274 
00275 
00276   <span class="comment">// ---------------------------------------------------------------------</span>
00277   FPSolverElasticFFT2D :: ~FPSolverElasticFFT2D() {
00278     <span class="keywordflow">if</span> (plan != NULL)
00279       deleteElasticPlan(plan);
00280   };  
00281 
00282   <span class="comment">// ---------------------------------------------------------------------</span>
00283   <span class="keywordtype">void</span> FPSolverElasticFFT2D :: solve() {
00284     <span class="comment">//printf("f:\n"); rhs.print();</span>
00285     solveElastic2D(plan, rhs.getArray(), ans.getArray());
00286   };
00287 
00288 
00289   <span class="comment">// ---------------------------------------------------------------------</span>
00290   Array&amp; FPSolverElasticFFT2D :: getAns() {
00291     <span class="keywordflow">return</span> ans;
00292   };
00293 
00294 
00295   <span class="comment">// ---------------------------------------------------------------------</span>
00296   Array&amp; FPSolverElasticFFT2D :: getRhs() {
00297     <span class="keywordflow">return</span> rhs;
00298   };
00299 
00300 }
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Tue Jan 10 08:16:41 2006 for flirt by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.1 </small></address>
</body>
</html>
