head	2.5;
access;
symbols;
locks; strict;
comment	@c @;


2.5
date	2004.02.16.19.39.57;	author tom;	state Exp;
branches;
next	2.2;

2.2
date	98.06.18.16.31.38;	author tom;	state Exp;
branches;
next	2.1;

2.1
date	96.10.24.13.58.03;	author tom;	state Exp;
branches;
next	2.0;

2.0
date	96.10.23.20.52.13;	author tom;	state Exp;
branches;
next	1.4;

1.4
date	95.06.30.16.56.00;	author tom;	state Exp;
branches;
next	1.3;

1.3
date	94.09.30.15.23.13;	author ty7777;	state Exp;
branches;
next	1.2;

1.2
date	94.09.14.18.37.19;	author ty7777;	state Exp;
branches;
next	1.1;

1.1
date	94.01.28.22.38.26;	author ty7777;	state Exp;
branches;
next	;


desc
@Initial checking in, working version.
@


2.5
log
@Feb 2004
@
text
@C$Log: locates.f,v $
c Revision 2.2  1998/06/18  16:31:38  tom
c *** empty log message ***
c
c Revision 2.1  1996/10/24  13:58:03  tom
c ATSPATH change
c
c Revision 2.0  1996/10/23  20:52:13  tom
c Solaris
c
c Revision 1.4  1995/06/30  16:56:00  tom
c added 953b
c
c Revision 1.3  1994/09/30  15:23:13  ty7777
c Reading xscale.
c
c Revision 1.2  1994/09/14  18:37:19  ty7777
c Modified to process sxr files generated by xray.
c
c Revision 1.1  1994/01/28  22:38:26  ty7777
c Initial revision
c
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
C  Program:      LOCATES.FTN
C
C  Author:       Tom O. Videen
C  Date:         03-Jun-87
C
C  History:
C     Revised version of LOCATE.FTN by Joel S. Perlmutter (9/22/85)
C     Modified by TOV 15-Jul-87 to change record length of .REG
C        file from 256 to 80;
C     Modified 15-Jan-88 by TOV to fix a bug in L1XSAVE.FTN and to
C        allow SXR file type 13 to be read.
C     Modified 25-Feb-88 by TOV to allow SXR file type 14 to be read.
C        (modified L1XGET)
C     Modified by Tom Yang on 28-Jan-94 to port to the UNIX platform.
C     Modified by Tom Yang on 12-Sep-94 to add path to TERMSET.
C     Modified by Tom Yang on 14-Sep-94 to read sxr files generated
C        by xray. l1xget.f is modified.
C     Modified 30-Sep-94 by Tom Yang to allow sxr file type 22 to be read
C        and write FILMPOS, SCANPOS, OFFSET, PEAKSLICE, XSCALE to output 
C        file.
C        (modified l1xegt, l1xsave.f)
C     Modified 30-Jun-95 TOV to add 953B to scanner list in l1al1pet.f
C
C  Intent:
C     This program finds or anatomically identifies any ROI
C     on PET images. It defines two coordinate spaces: that of the
C     PET machine and that of each individual's brain.  Reference
C     is made to a standard stereotactic atlas of the brain
C     (Talairach et al, 1967) but is generalizable to any other
C     stereotactic atlas.  Coordinate transformations from one space
C     into the other occur by standard trigonometric transformation
C     equations and utilize proportionate measurements in each axis.
C
C     Reference: Fox et al: J Comput Tomogr. Jan. 1985
C
C  Common Blocks from LOCATES.INC:
C     **LUINFO   - logical units (also /USRIO/)   (write)
C     **PETDATA   - tomograph parameters;         (write)
C     **ATLDATA   - atlas regions;                (write)
C     **SXRDATA   - skull xray parameters         (write)
C
C  Uses Subroutines:
C     L1AL2PET - convert atlas parameters to PET region files;
C     L1PET2AL - convert PET region files to stereotaxic coordinates;
C     L1XDATA  - get or save skull xray files;
C     L1PARMS  - view or alter atlas/tomograph parameters;
C
C  TERMINAL.LIB
C     TERMSET
C     TCONTROL
C     GETCHAR
C     GETINT
C     GETREAL
C     YESNO
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC****
C
      PROGRAM LOCATES
C
      INTEGER*4    AUXLU
      CHARACTER*1  BELL,CH,FORMFEED
      CHARACTER*80 Q,CHARSET
      CHARACTER*256 RCSHEADER
C
      INCLUDE 'locates.inc'
      DATA AUXLU, USERIN, USEROUT, DISK /1, 5, 6, 8/
C
      RCSHEADER = '$Id: locates.f,v 2.2 1998/06/18 16:31:38 tom Exp tom $'
      ATSPATH = '/usr/local/npg/lib/locates/'
C
      BELL = CHAR(7)
      FORMFEED = CHAR(12)
      PIX  = 0.27
      MF   = 0.9302
      NSLICES  = 7
      REFSLICE = 3
      ZATLDIM  = 7.0
      APATLDIM  = 16.3
      FILMPOS = 0
      SCANPOS = 0 
      OFFSET = 0 
      PEAKSLICE = 0 
      XSCALE = 0
      SLCSIZE  = 1.44
      ATLAS = ' '
      APXRAY = 0.0
      CH = 'S'
C
8500  FORMAT(16X,47(1H*))
8510  FORMAT(16X,A)
C
      CALL TERMSET (AUXLU, ATSPATH)
100   CALL TCONTROL (1, 0, 0)
      CALL TCONTROL (2, 0, 0)
      WRITE (USEROUT, 8500)
      WRITE (USEROUT, 8510) '                   LOCATES'
      WRITE (USEROUT, *)
      WRITE (USEROUT, 8510) 'Stereotaxic Localization of Regions of '//
     2  'Interest'
      WRITE (USEROUT, 8510) '             (SPIDERAM compatible)'
      WRITE (USEROUT, *)
      WRITE (USEROUT, 8510) '                 {18-Jun-98}'
      WRITE (USEROUT, 8500)
      WRITE (USEROUT, *)
      WRITE (USEROUT, *)
      WRITE (USEROUT, *)
      WRITE (USEROUT, 8510) 'A = Atlas to PET Regions Translation'
      WRITE (USEROUT, 8510) 'P = PET to Atlas Regions Translation'
      WRITE (USEROUT, 8510) 'S = Skull Xray Parameters (get/save)'
      WRITE (USEROUT, 8510) 'C = Atlas/PET Constants (view/change)'
      WRITE (USEROUT, 8510) 'E = Exit'
      WRITE (USEROUT, *) 
C
      Q = 'Option'
      CHARSET = 'APSCEapsce'
200   CALL GETCHAR(Q,CH,CHARSET)
      IF (CH.EQ.'A' .OR. CH.EQ.'a') THEN
        IF (APXRAY.EQ.0.0) THEN
          WRITE(USEROUT,*) '*** ERROR:  No Skull Xray Data ',
     2      'Entered',BELL
          GO TO 200
        ELSE
          CALL L1AL2PET
        END IF
      ELSE IF (CH.EQ.'P' .OR. CH.EQ.'p') THEN
        IF (APXRAY.EQ.0.0) THEN
          WRITE(USEROUT,*) '*** ERROR:  No Skull Xray Data ',
     2      'Entered',BELL
          GO TO 200
        ELSE
          CALL L1PET2AL
        END IF
      ELSE IF (CH.EQ.'S' .OR. CH.EQ.'s') THEN
        CALL L1XDATA
      ELSE IF (CH .EQ. 'C' .OR. CH .EQ. 'c') THEN
        CALL L1PARMS
      ELSE IF (CH .EQ. 'E' .OR. CH .EQ. 'e') THEN
        GO TO 300
      END IF
      GO TO 100
C
300   STOP
      END
@


2.2
log
@*** empty log message ***
@
text
@d2 3
d93 1
a93 1
      RCSHEADER = '$Id: locates.f,v 2.1 1996/10/24 13:58:03 tom Exp tom $'
@


2.1
log
@ATSPATH change
@
text
@d2 3
d90 1
a90 1
      RCSHEADER = '$Id: locates.f,v 2.0 1996/10/23 20:52:13 tom Exp tom $'
d124 1
a124 1
      WRITE (USEROUT, 8510) '                 {23-Oct-96}'
@


2.0
log
@Solaris
@
text
@d2 3
d87 2
a88 2
      RCSHEADER = '$Id: locates.f,v 1.4 1995/06/30 16:56:00 tom Exp tom $'
      ATSPATH = '/usr/local/lib/locates/'
@


1.4
log
@added 953b
@
text
@a0 2

C$Id: locates.f,v 1.3 1994/09/30 15:23:13 ty7777 Exp tom $
d2 3
a71 4
C  Instructions for Compiling/Linking:
C     Compile modules with COMPLOC.CSS
C     Link with LINKLOC.CSS
C
d82 1
a82 1
      DATA AUXLU, USERIN, USEROUT, DISK, IMAGE /1, 5, 6, 8, 9/
d84 1
a84 1
      RCSHEADER = '$Id: locates.f,v 1.3 1994/09/30 15:23:13 ty7777 Exp tom $'
d118 1
a118 1
      WRITE (USEROUT, 8510) '                 {30-Jun-95}'
@


1.3
log
@Reading xscale.
@
text
@d2 1
a2 1
C$Id: locates.f,v 1.2 1994/09/14 18:37:19 ty7777 Exp ty7777 $
d4 3
d37 1
a78 5
C
C
C
C
C
d87 1
a87 2
      RCSHEADER = '$Id: locates.f,v 1.2 1994/09/14 18:37:19 ty7777 Exp ty7777 $'
C
d121 1
a121 1
      WRITE (USEROUT, 8510) '                 {14-Sep-94}'
@


1.2
log
@Modified to process sxr files generated by xray.
@
text
@d2 1
a2 1
C$Id: locates.f,v 1.1 1994/01/28 22:38:26 ty7777 Exp ty7777 $
d4 3
d30 4
d88 1
a88 1
      RCSHEADER = '$Id: locates.f,v 1.1 1994/01/28 22:38:26 ty7777 Exp ty7777 $'
d100 5
@


1.1
log
@Initial revision
@
text
@d2 5
a6 2
C$Id$
C$Log$
d24 3
d81 1
a81 1
      RCSHEADER = '$Id$'
d101 7
a107 7
      CALL TERMSET(AUXLU)
100   CALL TCONTROL(1,0,0)
      CALL TCONTROL(2,0,0)
      WRITE(USEROUT,8500)
      WRITE(USEROUT,8510) '                   LOCATES'
      WRITE(USEROUT,*)
      WRITE(USEROUT,8510) 'Stereotaxic Localization of Regions of '//
d111 1
a111 1
      WRITE (USEROUT, 8510) '                 {27-Jan-94}'
@
