.TH SPIDERAM 1 "18-Feb-99" "Neuroimaging Lab"
.SH NAME
spideram - displays PET images as counts, CBF, CBV, OEF, CMRO2, or tissue activity; performs global and region-of-interest analysis.

.SH SYNOPSIS
spideram [font]

.SH DESCRIPTION

Spideram will read PET images in a variety of formats, display them in a window with many individual options, create and display regions-of-interest, compute statistics on these ROIs on individual or multiple image files, compute global or mean regional values. The program has been ported from an environment where menus appeared on a standard terminal screen and images were displayed on a Ramtek graphics display. The X environment uses one window (labeled Spideram) for menus and a second window (labeled Ramtek) for image display. Both windows may be adjusted and repositioned as desired. The initial position of the windows allows you to alternately click on the menu bars at the top to swap back-and-forth between them.

Note that if you are using the Open Look window manager, the Ramtek window initially overlays the Spideram window. Move the Ramtek window down slightly until you can see both menu bars at the top of you screen. You can then switch back and forth by moving your cursor from one window bar to the other and clicking the Select (left) button.

The default font size for the xterm window is 10x20. Should you want a different font,
select any valid X11 font (see /usr/openwin/lib/X11/fonts). For example, 6x10 or 8x12
are smaller fonts which are reasonably readable.

.SH PET IMAGE FILES

Image files may be in PETT VI (decoded only!), ECAT 953B or 961 format.
All images are represented internally in a 128x128 pixel array; images which are smaller than this are padded to maintain spideram-coordinate 64.5,64.5 as the slice center.

.SH METABOLIC CONVERSION

Images of PET counts represent the integral of radioactivity over the period of the PET scan (scaled by some arbitrary constant). These images may be converted to metabolic images using conversion factors generated by another program (METPROC). METPROC creates files with the extension HDR which contain necessary factors to convert PET counts to either CBF, CBV, OEF, or CMRO2. In order to display metabolic images: (1) an HDR file with the same root name as the image file must be located when the image file is read; (2) the PET image must be of an appropriate type to convert (HO or BU -> CBF, CO -> CBV, and HO, CO, plus OO -> OEM or CMRO2); and (3) you must select the appropriate type of processing in the Display Menu.

.SH TISSUE ACTIVITY CONVERSION

Images of PET counts may be converted to tissue activity in an analogous manner to metabolic conversion. An HDR file must be created with PETPROC and the appropriate type of processing selected in the Display Menu.

.SH MENUS

Spideram commands appear in screen-sized menus. Most commands require a single character keystroke with no carriage return. Where specific values must be entered, there is frequently a default value which is selected by typing carriage return.

.SH MAIN MENU

The main menu appears upon calling the program. It shows the program version date and a list of several submenus. These submenus are called by typing the single character indicating the desired path.

.SH SCAN FILE LIST MENU

Image files names must be entered in the scan file list before anything can be displayed or computed by any of the other menus. Note that the Fast File Entry option is omitted from the X version as our Unix does not have a keystroke-saving BIOC available. Also note that file names are case sensitive on the Suns--if your file name is all uppercase you must enter it in upper case. Also, if your files names end with a period, you must enter the period as part of the file name.

Note that Unix does not have 4-character volume names as are used on the Concurrents; instead, you have potentially much longer path names.  As the Scan File Menu allows only 20 characters for a file name, Spideram assumes either that your current working directory contains the image and HDR files or that you have entered the directory paths from the main menu (option "U", see below).

The options in the scan file list appear at the bottom of the menu:

A - selects a scan number in which an image file name may be entered. When a file name is typed the program attempts to locate the file immediately. If the file is not located, an error message appears. If the file is located, the number of slices appears under the column labeled #S. If an HDR file is located with the same root name, the date that file was created appears under Proc Date and the initials of the creator appears under By. The last 4 columns will be set with default values, explained below.

F - allows the multiplicative scaling factor for a scan file to be altered. The factor, appearing in the column Factor, is initially 1. If you wish to normalize 2 or more files before combining or subtracting them, you would enter some other value for the factor. Alternatively, you can compute these factors in the Global Averaging Menu and have them automatically entered.

C - allows an additive constant to be applied to a scan file before display or computations. This constant is initially 0, and one would be hard pressed to think of a good reason to change it. Nevertheless, the option exists.

H - allows appropriate HO and CO files to be identified for an OO file. This is necessary in order to convert an oxygen-image to units of OEF or CMRO2.

D - deletes one scan file from the list.

S - allows substitution of a new file for one in the list.

E - deletes the entire list. This may be necessary if you have been working with one type of image (e.g., 7-slice) and wish to work with a different type (e.g. 49-slice). Spideram is protective of its users and performs a variety of checks to prevent inappropriate image comparisons and region calculations, despite the occasional desire of users to circumvent these protections.

M - returns to the Main Menu.

.SH UNIX PATH SELECTION

This allows you to set the default paths for the image files and the HDR files. All image files are assumed to have a common path and all HDR files, but image and HDR file paths may differ. The path names you enter are case sensitive and may be up to 80 characters.  The last character of each path must be a "/".

.SH DISPLAY OPTIONS MENU
This menu must be selected to display any images. The options which you may alter are listed on the left side of the menu, while the current values for those options appear on the right side. Options which do not involve entering a number are selected by toggling through the available possibilities--after selecting the option, entering y or Y automatically switches to another selection; when the desired one appears, enter n or N. Displaying a new image writes over only that portion of the window which is used; if you want to clear the window before display, return to the Main Menu. Note that when you exit the Display Options Menu, the values of the options are set to those used for the last displayed image. This is necessary for the Regions Menu to determine appropriate values and displays.

O - selects one of 3 orientations: TRANSVERSE, CORONAL, or SAGITTAL.

S - selects one of several display formats using different pixel magnification prior to display
(factor given in parentheses): FULL SCREEN (7), QUARTER SCREEN (large) (5), QUARTER SCREEN (small) (4),
4x3 (3), 7x4 (2), and 7x7 (1).
The fonts 8x6 (1) and 3x2 (2) are intended for display on a PC with the screen at 1024x768.

P - selects the data representation. The default is UNPROCESSED, which is equivalent to PET counts. Other representations require and HDR file (see Metabolic Conversion and Tissue Activity Conversion above). These representations are: CBF, CBV, OEF, CMRO2, Decay-corrected Tissue Activity, and Non-decay-corrected Tissue Activity. If one of these options is selected, the image is converted before display and the color bar reflects this processing.

I - allows pixel interpolation to be enabled or disabled during display. If disabled, the displayed image will reflect the blockiness of the primary image data.

L - enables or disables some of the labeling on the display. Color bar labels will always appear.

V - selects the number of sections or slices to display. The upper bound is set by either the number of slices in the image or the number of slices which will fit on the screen in the selected format.

J - selects the increment in slice number between displayed slices (1 displays adjacent slices, 2 displays every other slice, etc.).

A - selects the primary scan file. If Image Comparisons is OFF, this is the image file which will be displayed.

B - selects a file which will be subtracted from image file A. This option only appears when Image Comparisons is ON.

C - selects a file which will be a divisor for image files A and/or B. This option only appears when Image Comparisons is ON.

X - enables or disables Image Comparisons. When ON, the program computes (A-B)/C where at least file A must be non-zero. If both B and C are zero, both negative and positive pixel values in image file A will be displayed if and only if a RELATIVE color scale has been selected in the Color Scales Menu.

T - selects various thresholding or templating options. The default is NONE. If THRESHOLD is selected, the cutoff must be set. SAVE TEMPLATE will save the mask in a temporary file where it may be used in displaying other image files. USE TEMPLATE uses a previously defined template for displaying the current image file. Note that templates are only created or altered for those slices which are displayed! If 49-slice images are being displayed, a predefined template may be used.

% - selects the percent cutoff to use to create a threshold or template. When a predefined template is used, the field after this option indicates the threshold used to create that template.

- - allows pixels to be stripped off a template. This is intended for stripping 2 pixels off the edges of a template created using 80% of a head attenuation image (leaving a template corresponding to brain).

Z - calls a zoom image menu.

D - displays the image(s) as selected by the options. When this is selected, a prompt appears for the first slice number to display, followed by (where applicable) the screen location to begin the display. For quarter-screen formats, 1 is upper left, 2 is upper right, 3 is lower left, and 4 is lower right. For 4x3, 7x4, and 7x7 formats 1 is top of screen, 2 is below it, etc.

M - returns to the Main Menu.

.SH COLOR SCALES MENU

This menu allow selection of different color tables and specification of the range of the color scale.

T - there are two types of scale: ABSOLUTE and RELATIVE. Absolute is the default; Relative should be used to display either both positive and negative values of a single image or a subtraction of two images or percent differences.

R - the range is either scaled to the SLICE MAXIMUM or to a SPECIFIED MAXIMUM.

S - a scale maximum must be set if the range is set to SCALE to SPECIFIED MAXIMUM. Separate default values are stored for ABSOLUTE and RELATIVE scales.

P - for RELATIVE scales, the scale may be either CENTERED, ZERO to MAXIMUM VALUE, or MINIMUM VALUE to ZERO.

L - loads a color table, selected by number from those at the bottom of the menu.  Note that after you have loaded a new color table you must move the cursor to the Ramtek window for that color table to appear.

.SH REGIONS MENU

This menu allows interactive definition of rectangular or irregular ROIs, calculations to be performed using these ROIs on the last displayed image slice. One would like to think that most of the options in this menu are obvious. If irregular ROIs are created, they may be drawn with the mouse. Rectangular ROIs created initially are 5x5 pixels centered on the image--one uses expand and reduce (selecting X, Y, or Z for the dimensions to alter) and numbers 1-9 to move this ROI to achieve the desired position. Locations of items of interest in an image can be determined by the midline and coronal line displays (these can indicate the appropriate sagittal or coronal section to display in the Display Menu). 

The current list of ROIs is listed by L and give the ROI number, name, type (Rectangular or Irregular), the slice number it was defined on, the x, y center of the ROI, and two values of perhaps lesser interest called A and B. For rectangular ROIs, A and B are the pixel X and Y dimensions, respectively, of the ROI; for irregular ROIs A is the stack address of the initial pixel in the ROI boundary and B is the number of pixels defining the boundary.

A set of ROIs may be saved in a file (and must be save in order to apply them to multiple image files in the Analysis of Regions Menu). For irregular ROIs the file format on the Suns is different from that on the Concurrents! If you wish to use irregular ROIs in common files on both systems, you must convert the files with a (yet-to-be-written) routine which changes hexadecimal values (Sun) to a binary representation (Concurrents)--see TOV.

.SH ANALYSIS OF REGIONS MENU

This menu lists all images currently entered in the scan file list at the top. Those files which one wants to apply a file of ROIs to are indicated with a * to the left of the number. 
These may be set with option N or deleted with option X. 

A - specifies processing of all the * selected files in one pass.

N - selects those scan files to denote *.

X - selects scan files to remove *.

O - specified processing of a single image file.

T - selects the type of processing (choosing among the same processing options as in the Display 
Options Menu); the currently selected processing type is listed at the bottom of the list.

P - sends the analysis output to a disk file (in addition to your screen); this may be saved and printed later or printed immediately from the Main Menu.

W - saves the ROI analysis in a SPED-format file with the extension RGT. This has been useful for processing with SPED and SAP and other programs on the Concurrents.

C - erases the output list (which is restricted to 20 files at a time). Write and/or Print the output before you clear the list.

L - restores the list of files (from option F below) to show the images in the scan file list (the default upon entering this menu).

F - changes the list of files at the top of this menu to show which image files have already been processed.

M - returns to the Main Menu.

.SH GLOBAL AVERAGING MENU

This menu allows averages to be computed over an entire PET image. Images by be processed using any of the same processing options as in the Display Options Menu. If you select printing of the output, the results will appear in a disk file as well as on your screen. This file may be printed later or immediately from the Main Menu. 

When any global mean value is computed for a scan file, you may choose to automatically alter the scaling factor in the Scan File List. This will normalize your images.

There are 3 options in this menu:

1 - computes a mean regional value applying a list of several predefined ROIs over the PET images. This predefined list uses both gray and white matter regions and requires the generation of an altered ROI file matched to each particular image's stereotaxic framework using the program LOCATES.

2- computes whole slice averages. You may select which slices to include and whether to template to some particular level or use a predefined template (typically you will threshold to 40% of entire image for HO scans).

3 - is similar to the previous option, but in addition it computes separate left and right brain averages.
Having made selections, a summary appears. At this point you may either:

C - compute the averages.

R - repeat and alter the selections.

M - exit to the Main Menu

.SH HALF-BRAIN OR SPLIT IMAGES

This menu allows a split-image display where each half of a brain may have a different representation (e.g., the famous panic-disorder image).

.SH PRINT ALL CURRENT OUTPUT

This sends the currently defined printer output file to your default printer (defined by setenv PRINTER in your personal .login file). It does not alter or delete this file, which will continue to be appended until you select a different print file.

.SH REFRESH WINDOW

This will entirely erase the window in which images are displayed.

.SH EXIT

Exits the program and terminates both the menu and display windows. Unlike other options in the Main Menu, you must type Y followed by a carriage return to exit.

.SH AUTHORS

Tom O. Videen: 1985-19959

Modified and ported to X environment by Tom Yang, Todd Gamble, and Tom Videen: 1991

Based on METDISP by Mark Mintun: 1982-1987.
